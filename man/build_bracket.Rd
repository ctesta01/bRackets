% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/build_bracket.R
\name{build_bracket}
\alias{build_bracket}
\title{Build bracket geometry (segments + optional label) for ggplot2 annotations}
\usage{
build_bracket(
  orientation = c("v", "h"),
  x0 = NULL,
  x1 = NULL,
  y0 = NULL,
  y1 = NULL,
  position = NULL,
  side = NULL,
  tick = 0.1,
  pad = 0,
  text = NULL,
  text_nudge = 0.08,
  text_size = 4,
  color = "black",
  linewidth = 0.9,
  linetype = "solid",
  segments = NULL,
  label_xy = NULL,
  facet_vars = NULL
)
}
\arguments{
\item{orientation}{Bracket orientation. \code{"v"} draws a vertical bracket at
a fixed x-position spanning \code{y0} to \code{y1}. \code{"h"} draws a horizontal
bracket at a fixed y-position spanning \code{x0} to \code{x1}.}

\item{x0, x1}{Bracket x-coordinates. For \code{orientation = "v"}, only \code{x0}
is used (the bracket x-position). For \code{orientation = "h"}, \code{x0} and
\code{x1} define the bracket endpoints.}

\item{y0, y1}{Bracket y-coordinates. For \code{orientation = "v"}, \code{y0} and
\code{y1} define the bracket endpoints. For \code{orientation = "h"}, only
\code{y0} is used (the bracket y-position) and \code{y1} is ignored.}

\item{position}{Bracket placement. For \code{orientation = "v"}, one of
\code{"left"} or \code{"right"} indicating where the bracket sits; ticks point
inward (toward the plotted region). For \code{orientation = "h"}, one of
\code{"top"} or \code{"bottom"}; ticks point inward.
If \code{NULL}, defaults to \code{"left"} for vertical and \code{"top"} for
horizontal.}

\item{side}{Deprecated alias for \code{position}. For \code{orientation = "v"},
\code{side} must be \code{"left"} or \code{"right"}. For \code{orientation = "h"},
\code{side} must be \code{"up"} or \code{"down"} and is mapped to
\code{position = "bottom"} or \code{position = "top"}, respectively.}

\item{tick}{Tick length in data units. For vertical brackets, tick length is along
the x-axis. For horizontal brackets, tick length is along the y-axis.}

\item{pad}{Padding in data units added to the bracket span. For vertical brackets,
expands the y-span; for horizontal brackets, expands neither x-span nor y-span
(it is applied only in the vertical case in the current implementation).}

\item{text}{Optional label to display near the bracket. If \code{NULL}, no label
data is returned.}

\item{text_nudge}{Label offset in data units from the bracket. If \code{label_xy}
is \code{NULL}, \code{text_nudge} determines the default text position relative
to the bracket depending on \code{orientation} and \code{position}.}

\item{text_size}{Label size (passed through as a numeric column named \code{size}
for downstream use by \code{\link[ggplot2]{geom_text}}).}

\item{color}{Line and label color.}

\item{linewidth}{Line width (passed through as a numeric column named \code{linewidth}).}

\item{linetype}{Line type (e.g., \code{"solid"}, \code{"dashed"}).}

\item{segments}{Optional low-level override for bracket geometry. A data frame with
columns \code{x}, \code{xend}, \code{y}, \code{yend} (one row per segment).
If provided, the function will not compute bracket geometry from
\code{orientation/x0/x1/y0/y1/position}.}

\item{label_xy}{Optional low-level override for label placement. A list-like object
with elements \code{x} and \code{y}. Required if \code{segments} is provided and
\code{text} is not \code{NULL}.}

\item{facet_vars}{Optional named list of facetting variables and values to append
to the returned segment and label data. Useful for \code{\link[ggplot2]{facet_wrap}}
or \code{\link[ggplot2]{facet_grid}} so brackets appear only in the intended panels.}
}
\value{
A list with two elements:
\describe{
\item{segments}{A tibble with columns \code{x}, \code{xend}, \code{y}, \code{yend}
and styling columns \code{color}, \code{linewidth}, \code{linetype}. If
\code{facet_vars} is provided, those columns are included as well.}
\item{labels}{Either \code{NULL} (if \code{text} is \code{NULL}) or a tibble
with columns \code{x}, \code{y}, \code{label}, \code{hjust}, \code{vjust},
\code{color}, \code{size}, and any facet columns from \code{facet_vars}.}
}
}
\description{
Construct the data frames needed to draw an annotated bracket in ggplot2.
The returned object contains (i) a segment data frame suitable for
\code{\link[ggplot2]{geom_segment}} and (ii) an optional label data frame
suitable for \code{\link[ggplot2]{geom_text}}.
}
\details{
Brackets can be specified at a high level using \code{orientation}, \code{x0/x1},
\code{y0/y1}, and \code{position}, or at a low level by supplying explicit
\code{segments}. When \code{segments} is provided, bracket geometry is used
as-is and label placement cannot be inferred.

For faceting, provide \code{facet_vars} (a named list) containing the facetting
variables and their values; these columns are appended to the returned segment
and label data so the annotation appears only in matching panels.
}
\examples{
# A vertical bracket with a label, intended for a single facet panel
b <- build_bracket(
  orientation = "v",
  x0 = 0.8, y0 = 1.0, y1 = 2.0,
  position = "left",
  text = "***",
  facet_vars = list(group = "High")
)

# Use the returned data frames in ggplot2 layers:
# ggplot(...) +
#   geom_segment(data = b$segments, aes(x=x, xend=xend, y=y, yend=yend),
#                inherit.aes = FALSE) +
#   geom_text(data = b$labels, aes(x=x, y=y, label=label),
#             inherit.aes = FALSE)

}
